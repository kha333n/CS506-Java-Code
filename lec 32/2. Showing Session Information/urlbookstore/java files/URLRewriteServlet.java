import java.io.*;import java.net.*;import javax.servlet.*;import javax.servlet.http.*;import java.util.*;public class URLRewriteServlet extends HttpServlet {		// used to generate a unique value which is	// used as a cookie value	public static int S_ID = 1;	// used to store HashMaps of indiviual users	public static HashMap<String, HashMap> globalMap = new HashMap<String, HashMap>();	// Handles the HTTP GET method.	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {		processRequest(request, response);	}	// Handles the HTTP <code>POST</code> method.	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {		processRequest(request, response);	}	// called from both doGet() & doPost()	protected void processRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {		// declaring user's HashMap		HashMap<String, String> sessionInfo = null;		// reading sessionId		String sID = request.getParameter("JSESSIONID");		/* if parameter JSESSIONID is received, means that user is		visiting the site for the first time. */		if (sID == null) {			// make a unique string			sID = makeUniqueString();			// creating a HashMap where books selected by the			// user will be stored			sessionInfo = new HashMap<String, String>();						// add the user's HashMap (sessionInfo) into the			// globalMap against unique string i.e. sID			globalMap.put(sID, sessionInfo);		}else {			// if parameter "JSESSIONID" has some value			// retrieve a HashMap from the globalMap against			// sID i.e. unique string which is your sessionID			sessionInfo = (HashMap<String, String>)globalMap.get(sID);		}				response.setContentType("text/html;charset=UTF-8");		PrintWriter out = response.getWriter();		out.println("<html>");		out.println("<head>");		out.println("<title>Shopping Cart Example</title>");		out.println("</head>");		out.println("<body>");		out.println("<h1>Online Book Store</h1>");		// Making three URLS by using query string mechanism		// The attributes/parameters are JSSESSIONID and book name (like		// firstCB) along with values sID and book name respectively		String firsturl = "urlrewriteservlet?JSESSIONID=" + sID + "&firstCB=firstCB";		String secondurl = "urlrewriteservlet?JSESSIONID=" + sID + "&secondCB=secondCB";		out.println("<h3><a href=" + firsturl + ">" + " java core servlts </a> </h3>" + "<br>"+		"<h3><a href=" + secondurl + ">" + " java how to program </a> </h3>" + "<br>");		out.println("<br/>");		out.println("<h1>You have selected following books</h1>");		out.println("<br/>");		//retrieving params that are emebded in URLs		String fBook = request.getParameter("firstCB");		String sBook = request.getParameter("secondCB");		// if first book is selected then add it to		// user's HashMap i.e. sessionInfo		if ( fBook != null && fBook.equals("firstCB") ) {			sessionInfo.put("firstCB", "java core servlets");		}		// if second book is selected then add it to		// user's HashMap i.e. sessionInfo		if (sBook != null && sBook.equals("secondCB")){			sessionInfo.put("secondCB", "java how to program");		}		// used to display the books currently stored in		// the user's HashMap i.e. sessionInfo		printSessionInfo(out, sessionInfo);		out.println("</body>");		out.println("</html>");		out.close();	} // end processRequest()	// method used to generate a unique string	public String makeUniqueString(){		return "ABC" + S_ID++;	}	// returns a reference global HashMap.	public static HashMap findTableStoringSessions(){		return globalMap;	}	// used to print the books currently stored in	// user's HashMap. i.e. sessionInfo	public void printSessionInfo(PrintWriter out, HashMap sessionInfo) {		String title = "";		title= (String)sessionInfo.get("firstCB");				if (title != null){			out.println("<h3> "+ title +"</h3>");		}		title= (String)sessionInfo.get("secondCB");				if (title != null){			out.println("<h3> "+ title +"</h3>");		}	}} // end URLRewriteServlet